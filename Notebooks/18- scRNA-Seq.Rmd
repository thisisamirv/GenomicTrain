---
title: "scRNA-Seq"
output: 
  pdf_document: 
    number_sections: yes
    toc: yes
header-includes: 
  - \usepackage{graphics}
  - \usepackage{float}
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
rm(list = ls())
```

\newpage

# Experimental procedures
## History of technology
```{r, echo=FALSE, fig.align='center', fig.pos='H', fig.show='hold', out.width = '100%'}
knitr::include_graphics("Figures/18-1.jpeg")
```

## An overview of scRNA-Seq procedures
```{r, echo=FALSE, fig.align='center', fig.pos='H', fig.show='hold', out.width = '100%'}
knitr::include_graphics("Figures/18-2.jpeg")
```

A) Single-cell isolation and capture is the process of capturing high-quality individual cells from a tissue, thereby extracting precise genetic and biochemical information and facilitating the study of unique genetic and molecular mechanisms. The most common techniques of single-cell isolation and capture include limiting dilution, fluorescence-activated cell sorting (FACS), magnetic-activated cell sorting, microfluidic system, and laser microdissection.

B) After the process of converting RNA into the first-strand cDNA, the resulting cDNA are amplified by either polymerase chain reaction (PCR) or in vitro transcription (IVT). To overcome amplification-associated biases, unique molecular identifiers (UMIs) were introduced to barcode each individual mRNA molecule within a cell in the reverse transcription step.

## Limitations
The scRNA-seq has gradually revealed some inherent methodological issues, such as ‘artificial transcriptional stress responses’. It means that the dissociation process could induce the expression of stress genes, which lead to artificially changes in cell transcription patterns. Dissociation of tissues into single-cell suspension at 4°C has thus been suggested to minimize the isolation procedure-induced gene expression changes.

## snRNA-Seq
Single-nucleus RNA sequencing (snRNA-seq) is an alternative single-cell sequencing method. Instead of sequencing all the mRNA in the cytoplasm of cells, scRNA-seq only captures the mRNAs in the nucleus of cells. snRNA-seq becomes very useful in many tissue types, such as muscle tissue, heart, kidney, lung, pancreas, and various tumor tissues. It is particularly applicable in brain tissues, which are difficult to be dissociated to obtain intact cells.

It should be noted that snRNA-seq only captures transcripts in the nucleus, which might fail to capture important biological processes related to, that is, mRNA processing, RNA stability and metabolism.

## Protocols
```{r, echo=FALSE, fig.align='center', fig.pos='H', fig.show='hold', out.width = '100%'}
knitr::include_graphics("Figures/18-3.jpeg")
```

# Roadmap for typical scRNA-Seq analysis
```{r, echo=FALSE, fig.align='center', fig.pos='H', fig.show='hold', out.width = '100%'}
knitr::include_graphics("Figures/18-4.jpeg")
```

# Data preprocessing
Basic formats of raw sequencing data for single-cell transcriptome include FASTQ and BCL format, which depend on the data source and sequencing platform.

```{r, echo=FALSE, fig.align='center', fig.pos='H', fig.show='hold', out.width = '100%'}
knitr::include_graphics("Figures/18-5.jpeg")
```

The fundamental steps in raw data processing include: quality control, read alignment/mapping, cell barcode (CB) identification and correction, and the estimation of molecule counts through the resolution of unique molecular identifiers (UMIs).

## Quality control
**FastQC** can be applied on FASTQ data to assess the quality of raw scRNA-Seq data.

## Alignment and quantification
High-quality reads need to be mapped to the specific reference genome using an appropriate aligner. The *count* is the most important function of **Cell Ranger**, which has wrapped up the alignment, filtering, UMI counting, and other practical steps internally. The Cell Ranger uses an aligner called **STAR**, which performs splicing-aware alignment of reads to the genome and then uses transcriptional annotation GTF file to categorize these reads into exons, introns, and intergenic based on whether the reads are aligned to the genome confidently.

# General analyses
## Low quality cell filtration
To eliminate the gene expression interference from low-quality cells, it is necessary to conduct a second round of quality control with suitable tools, such as **Seurat**. The following QC indicators should be used to judge whether a cell should be retained:

- 200 < total number of expressed genes per cell (nGenes < 2500);
- 300 < total number of UMIs per cell (nUMIs < 15000);
- percentage of UMIs mapped to mitochondrial genes (MT%) < 10%.

**Focus:** It should be noted the filtration of cells based on mitochondrial genes should be carefully applied as some cell types, such as cardiomyocytes, are biologically more abundant in expressing these genes.

## Normalization
Normalization is intended to counteract technical noise or bias and to ensure comparability between each cell. Normalization could be achieved using the **Linnorm** tool.

## HVG selection
The subsets of features that exhibit high cell-to-cell variation in the data set are also called highly variable genes (HVGs). HVGs not only highlight biological signals but also greatly accelerate the downstream analysis of scRNA-Seq data due to the significant reduction in the computation volume. **scran** is the best tool for HVG selection.

## Batch rectification
A novel deep learning-based method, called **deepMNN**, is great for correcting batch effect in scRNA-Seq. data.

## Dimension reduction
For scRNA-Seq data, two rounds of dimension reduction are generally required:

1. Principal component analysis (PCA) dimension reduction first,
2. Then t-distributed stochastic neighbor embedding (t-SNE) or Uniform Manifold Approximation and Projection (UMAP) dimension reduction for visualization. UMAP has a clear advantage over t-SNE in the continuity of the cell subsets because it preserves more of the global structure, although t-SNE is still applied in many single-cell studies, seemingly due to better visual preferences.

## Clustering
**Seurat** is the best tool for clustering.

## Cell type annotation
Generally, the workflow for annotating cells in scRNA-seq data includes three main steps: automatic annotation, manual annotation, and validation with wet experiments. **Seurat** is the best tool for annotating the major cell types.

# Exploratory analyses
## GSVA
GSVA is widely used in functional enrichment analysis and other standard analyses in a pathway-centered way. GSVA can calculate enrichment scores for different signaling pathways in each sample to assess the causes of phenotypic differences, which can be used as a supplement to the KEGG pathway to make the results more biologically explanatory.

## TF identification
To identify the transcription factors enriched in each cell cluster from scRNA-seq data, **SCENIC** was developed which enabled inferring TFs because it firstly achieves the enrichment of TF motifs by searching the putative regulatory regions of target genes. Then TF motif enrichment can realize the connection of candidate TF regulatory factors with candidate target genes.

## Cell trajectory
Pseudo-time analysis can be used to infer the trajectory of cells at the single-cell level, which is expected to discover rare cell types and cryptic states. **Monocle** is one of the most broadly used tool for pseudo-time analysis, which learns an explicit principal graph to describe the data and rebuilds single-cell trajectories by embedding reversed graph to improve the robustness and accuracy of predicted trajectories.

## Cell-cell interaction
- If the structural composition of the ligand and receptor is expected to be considered, **CellPhoneDB** should be used

- If the regulation of cofactors (such as promoters and antagonists) is expected to be taken into account, **CellChat** can be selected to improve performance.

- It is also recommended to combine multiple cell-cell communication analysis tools flexibly to avoid methodical bias.

## Cell cycle
The *CellCycleScoring* function in the **Seurat** assigns a quantitative score to each cell according to the expression of G2/M and S phase marker genes embedded in its built-in package.
